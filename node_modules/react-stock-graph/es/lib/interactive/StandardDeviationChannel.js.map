{"version":3,"sources":["../../../../src/lib/interactive/StandardDeviationChannel.js"],"names":["React","Component","PropTypes","isDefined","isNotDefined","noop","getValueFromOverride","terminate","saveNodeType","isHoverForInteractiveType","EachLinearRegressionChannel","MouseLocationIndicator","HoverTextNearMouse","StandardDeviationChannel","props","handleStart","bind","handleEnd","handleDrawLine","handleDragLine","handleDragLineComplete","getSelectionState","nodes","state","index","newXYValue","setState","override","moreProps","channels","newChannels","map","each","idx","start","x1Value","y1Value","end","x2Value","y2Value","selected","onComplete","xyValue","current","mouseMoved","onStart","e","appearance","d","enabled","snapTo","currentPositionRadius","currentPositionStroke","currentPositionOpacity","currentPositionStrokeWidth","hoverText","tempLine","eachAppearance","propTypes","bool","isRequired","func","onSelect","string","number","shape","stroke","strokeOpacity","strokeWidth","fill","fillOpacity","edgeStrokeWidth","edgeStroke","edgeFill","r","object","array","defaultProps","close","enable","bgHeight","bgWidth","text"],"mappings":"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","file":"StandardDeviationChannel.js","sourcesContent":["\n\nimport React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\n\nimport { isDefined, isNotDefined, noop } from \"../utils\";\n\nimport {\n\tgetValueFromOverride,\n\tterminate,\n\tsaveNodeType,\n\tisHoverForInteractiveType,\n} from \"./utils\";\n\nimport EachLinearRegressionChannel from \"./wrapper/EachLinearRegressionChannel\";\nimport MouseLocationIndicator from \"./components/MouseLocationIndicator\";\nimport HoverTextNearMouse from \"./components/HoverTextNearMouse\";\n\nclass StandardDeviationChannel extends Component {\n\tconstructor(props) {\n\t\tsuper(props);\n\n\t\tthis.handleStart = this.handleStart.bind(this);\n\t\tthis.handleEnd = this.handleEnd.bind(this);\n\t\tthis.handleDrawLine = this.handleDrawLine.bind(this);\n\t\tthis.handleDragLine = this.handleDragLine.bind(this);\n\t\tthis.handleDragLineComplete = this.handleDragLineComplete.bind(this);\n\n\t\tthis.terminate = terminate.bind(this);\n\t\tthis.saveNodeType = saveNodeType.bind(this);\n\n\t\tthis.getSelectionState = isHoverForInteractiveType(\"channels\")\n\t\t\t.bind(this);\n\n\t\tthis.nodes = [];\n\t\tthis.state = {};\n\t}\n\thandleDragLine(index, newXYValue) {\n\t\tthis.setState({\n\t\t\toverride: {\n\t\t\t\tindex,\n\t\t\t\t...newXYValue\n\t\t\t}\n\t\t});\n\t}\n\thandleDragLineComplete(moreProps) {\n\t\tconst { override } = this.state;\n\t\tconst { channels } = this.props;\n\t\tif (isDefined(override)) {\n\n\t\t\tconst newChannels = channels\n\t\t\t\t.map((each, idx) => idx === override.index\n\t\t\t\t\t? {\n\t\t\t\t\t\t...each,\n\t\t\t\t\t\tstart: [override.x1Value, override.y1Value],\n\t\t\t\t\t\tend: [override.x2Value, override.y2Value],\n\t\t\t\t\t\tselected: true,\n\t\t\t\t\t}\n\t\t\t\t\t: each);\n\t\t\tthis.setState({\n\t\t\t\toverride: null,\n\t\t\t}, () => {\n\t\t\t\tthis.props.onComplete(newChannels, moreProps);\n\t\t\t});\n\t\t}\n\t}\n\thandleDrawLine(xyValue) {\n\t\tconst { current } = this.state;\n\n\t\tif (isDefined(current) && isDefined(current.start)) {\n\t\t\tthis.mouseMoved = true;\n\t\t\tthis.setState({\n\t\t\t\tcurrent: {\n\t\t\t\t\tstart: current.start,\n\t\t\t\t\tend: xyValue,\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\thandleStart(xyValue) {\n\t\tconst { current } = this.state;\n\n\t\tif (isNotDefined(current) || isNotDefined(current.start)) {\n\t\t\tthis.mouseMoved = false;\n\n\t\t\tthis.setState({\n\t\t\t\tcurrent: {\n\t\t\t\t\tstart: xyValue,\n\t\t\t\t\tend: null,\n\t\t\t\t}\n\t\t\t}, () => {\n\t\t\t\tthis.props.onStart();\n\t\t\t});\n\t\t}\n\t}\n\thandleEnd(xyValue, moreProps, e) {\n\t\tconst { current } = this.state;\n\t\tconst { appearance, channels } = this.props;\n\n\t\tif (this.mouseMoved\n\t\t\t&& isDefined(current)\n\t\t\t&& isDefined(current.start)\n\t\t) {\n\t\t\tconst newChannels = [\n\t\t\t\t...channels.map(d => ({ ...d, selected: false })),\n\t\t\t\t{\n\t\t\t\t\tstart: current.start,\n\t\t\t\t\tend: xyValue,\n\t\t\t\t\tselected: true,\n\t\t\t\t\tappearance,\n\t\t\t\t}\n\t\t\t];\n\n\t\t\tthis.setState({\n\t\t\t\tcurrent: null,\n\t\t\t}, () => {\n\t\t\t\tthis.props.onComplete(newChannels, moreProps, e);\n\t\t\t});\n\t\t}\n\t}\n\trender() {\n\t\tconst { appearance } = this.props;\n\t\tconst { enabled, snapTo } = this.props;\n\t\tconst { currentPositionRadius, currentPositionStroke } = this.props;\n\t\tconst { currentPositionOpacity, currentPositionStrokeWidth } = this.props;\n\t\tconst { hoverText, channels } = this.props;\n\t\tconst { current, override } = this.state;\n\n\t\tconst tempLine = isDefined(current) && isDefined(current.end)\n\t\t\t? <EachLinearRegressionChannel\n\t\t\t\tinteractive={false}\n\t\t\t\tx1Value={current.start[0]}\n\t\t\t\tx2Value={current.end[0]}\n\t\t\t\tappearance={appearance}\n\t\t\t\thoverText={hoverText}\n\t\t\t/>\n\t\t\t: null;\n\n\t\treturn <g>\n\t\t\t{channels.map((each, idx) => {\n\t\t\t\tconst eachAppearance = isDefined(each.appearance)\n\t\t\t\t\t? { ...appearance, ...each.appearance }\n\t\t\t\t\t: appearance;\n\n\t\t\t\treturn <EachLinearRegressionChannel key={idx}\n\t\t\t\t\tref={this.saveNodeType(idx)}\n\t\t\t\t\tindex={idx}\n\t\t\t\t\tselected={each.selected}\n\n\t\t\t\t\tx1Value={getValueFromOverride(override, idx, \"x1Value\", each.start[0])}\n\t\t\t\t\tx2Value={getValueFromOverride(override, idx, \"x2Value\", each.end[0])}\n\n\t\t\t\t\tappearance={eachAppearance}\n\t\t\t\t\tsnapTo={snapTo}\n\t\t\t\t\thoverText={hoverText}\n\n\t\t\t\t\tonDrag={this.handleDragLine}\n\t\t\t\t\tonDragComplete={this.handleDragLineComplete}\n\t\t\t\t\tedgeInteractiveCursor=\"react-stockcharts-move-cursor\"\n\t\t\t\t/>;\n\t\t\t})}\n\t\t\t{tempLine}\n\t\t\t<MouseLocationIndicator\n\t\t\t\tenabled={enabled}\n\t\t\t\tsnap\n\t\t\t\tsnapTo={snapTo}\n\t\t\t\tr={currentPositionRadius}\n\t\t\t\tstroke={currentPositionStroke}\n\t\t\t\topacity={currentPositionOpacity}\n\t\t\t\tstrokeWidth={currentPositionStrokeWidth}\n\t\t\t\tonMouseDown={this.handleStart}\n\t\t\t\tonClick={this.handleEnd}\n\t\t\t\tonMouseMove={this.handleDrawLine}\n\t\t\t/>\n\t\t</g>;\n\t}\n}\n\nStandardDeviationChannel.propTypes = {\n\tenabled: PropTypes.bool.isRequired,\n\tsnapTo: PropTypes.func.isRequired,\n\n\tonStart: PropTypes.func.isRequired,\n\tonComplete: PropTypes.func.isRequired,\n\tonSelect: PropTypes.func,\n\n\tcurrentPositionStroke: PropTypes.string,\n\tcurrentPositionStrokeWidth: PropTypes.number,\n\tcurrentPositionOpacity: PropTypes.number,\n\tcurrentPositionRadius: PropTypes.number,\n\n\tappearance: PropTypes.shape({\n\t\tstroke: PropTypes.string.isRequired,\n\t\tstrokeOpacity: PropTypes.number.isRequired,\n\t\tstrokeWidth: PropTypes.number.isRequired,\n\t\tfill: PropTypes.string.isRequired,\n\t\tfillOpacity: PropTypes.number.isRequired,\n\t\tedgeStrokeWidth: PropTypes.number.isRequired,\n\t\tedgeStroke: PropTypes.string.isRequired,\n\t\tedgeFill: PropTypes.string.isRequired,\n\t\tr: PropTypes.number.isRequired,\n\t}).isRequired,\n\n\thoverText: PropTypes.object.isRequired,\n\tchannels: PropTypes.array.isRequired,\n};\n\nStandardDeviationChannel.defaultProps = {\n\tsnapTo: d => d.close,\n\tappearance: {\n\t\tstroke: \"#000000\",\n\t\tfillOpacity: 0.2,\n\t\tstrokeOpacity: 1,\n\t\tstrokeWidth: 1,\n\t\tfill: \"#8AAFE2\",\n\t\tedgeStrokeWidth: 2,\n\t\tedgeStroke: \"#000000\",\n\t\tedgeFill: \"#FFFFFF\",\n\t\tr: 5,\n\t},\n\n\tonStart: noop,\n\tonComplete: noop,\n\tonSelect: noop,\n\n\tcurrentPositionStroke: \"#000000\",\n\tcurrentPositionOpacity: 1,\n\tcurrentPositionStrokeWidth: 3,\n\tcurrentPositionRadius: 4,\n\n\thoverText: {\n\t\t...HoverTextNearMouse.defaultProps,\n\t\tenable: true,\n\t\tbgHeight: 18,\n\t\tbgWidth: 175,\n\t\ttext: \"Click and drag the edge circles\",\n\t},\n\tchannels: [],\n};\n\nexport default StandardDeviationChannel;\n"]}